<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transaction History</title>
    <link rel="stylesheet" th:href="@{/css/general_styles.css}">
    <link rel="stylesheet" th:href="@{/css/transactionspage_styles.css}">
    <script th:src="@{/scripts/transactionspage_script.js}" defer></script>
</head>
<body>

<!-- H1 Heading for Webapp Title -->
<header>
    <h1 class="webapp-title">Virtual Vending Machine Webapp</h1>
</header>

<!-- Display Logged-In User -->
<div class="user-info">
    <p>Logged In As: <span th:text="${username}">Guest</span></p>
</div>

<main>
    <h2>Your Transactions History</h2>

    <!-- Instructions Panel -->
    <div class="instructions-panel">
        <h3>Viewing Transactions</h3>
        <ul>
            <li>All of your transactions are displayed in the table by default.</li>
            <li>Use the filter menu to narrow down or query transactions.</li>
            <li>Click on any table header to sort by that column.</li>
            <li>Click headers repeatedly to toggle between ascending/descending order.</li>
            <li>Relevant tooltips will appear when hovering over a header.</li>
            <li>Double click outside headers to reset sorting.</li>
        </ul>
    </div>

    <!-- Filter Menu to Query the Data -->
    <div class="filter-menu">
        <h3>Querying/Filtering Transactions Menu</h3>

        <!-- Transaction ID Filter -->
        <div class="id-filter">
            <label for="transactionId">Transaction ID:</label>
            <input type="number" id="transactionId" placeholder="Enter ID" min="0" oninput="this.value = this.value.replace(/[^0-9]/g, '');">
        </div>

        <!-- Date Range Filters -->
        <div class="date-filters">
            <div class="date-input-container">
                <label for="startDate">Date From:</label>
                <input type="date" id="startDate">
            </div>
            <div class="date-input-container">
                <label for="endDate">Date To:</label>
                <input type="date" id="endDate">
            </div>
        </div>

        <!-- Money Filters -->
        <div class="money-filters">

            <!-- Total Cost Range -->
            <div class="money-column">
                <label for="minTotalCost">Total Cost:</label>

                <div class="money-input-container">
                    <input type="number" id="minTotalCost" class="money-filter-input"  placeholder="Min" min="0" step="1">
                </div>

                <div class="money-input-container">
                    <input type="number" id="maxTotalCost" class="money-filter-input" placeholder="Max" min="0" step="1">
                </div>
            </div>

            <!-- Payment Received Range -->
            <div class="money-column">
                <label for="minPayment">Payment Received:</label>

                <div class="money-input-container">
                    <input type="number" id="minPayment" class="money-filter-input" placeholder="Min" min="0" step="1">
                </div>

                <div class="money-input-container">
                    <input type="number" id="maxPayment" class="money-filter-input" placeholder="Max" min="0" step="1">
                </div>
            </div>

            <!-- Change Given Range -->
            <div class="money-column">
                <label for="minChange">Change Given:</label>

                <div class="money-input-container">
                    <input type="number" id="minChange" class="money-filter-input" placeholder="Min" min="0" step="0.1">
                </div>

                <div class="money-input-container">
                    <input type="number" id="maxChange" class="money-filter-input" placeholder="Max" min="0" step="0.1">
                </div>
            </div>
        </div>

        <!-- Buttons -->
        <div class="filter-buttons">
            <button onclick="applyFilters()">Apply Filters</button>
            <button onclick="resetFilters()">Reset Filters</button>
        </div>

    </div>


    <!-- Transactions List -->
    <div class="transactions-container">
        <div class="transactions-table-wrapper">
            <table id="transactionsTable" class="transactions-table">
                <thead>
                    <tr>
                        <th id="transactionIdHeader" onclick="sortTableByColumn('id')" title="Click to sort ascending">Transaction ID</th>
                        <th id="dateHeader" onclick="sortTableByColumn('date')" title="Click to sort ascending">Date</th>
                        <th id="timeHeader" onclick="sortTableByColumn('time')" title="Click to sort ascending">Time</th>
                        <th id="totalCostHeader" onclick="sortTableByColumn('totalCost')" title="Click to sort ascending">Total Cost</th>
                        <th id="paymentReceivedHeader" onclick="sortTableByColumn('paymentReceived')" title="Click to sort ascending">Payment Received</th>
                        <th id="changeGivenHeader" onclick="sortTableByColumn('changeGiven')" title="Click to sort ascending">Change Given</th>
                        <th>Receipt</th>
                    </tr>
                </thead>
                <tbody>
                <!-- Transactions will be dynamically inserted here -->
                </tbody>
            </table>
        </div>
    </div>

</main>

<!-- Home Button -->
<a th:href="@{/home}" class="home-button-link">
    <button class="home-button">Home</button>
</a>

</body>
</html>
